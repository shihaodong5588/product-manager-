# 🎯 AI 模型实时选择功能

## ✅ 功能说明

现在您可以在 AI 助手界面**实时选择**不同的 Gemini 模型进行分析，无需修改配置文件或重启服务器！

## 📸 使用方式

1. 访问 http://localhost:3000/ai-assistant
2. 在"智能分析"标签页中，您会看到新增的 **"AI 模型"** 选择器
3. 选择您想要使用的模型：
   - **⚡ Flash**（推荐）- 快速、经济、平衡
   - **🧠 Pro** - 最强性能，适合复杂分析
   - **🚀 Lite** - 超快速，适合简单任务

4. 配置好其他参数后，点击"开始分析"
5. 系统会使用您选择的模型进行分析

## 🎨 界面特性

### 模型选择器
- 清晰的图标标识（⚡🧠🚀）
- 简洁的描述文字
- 动态提示信息（根据所选模型显示不同说明）

### 实时反馈
- 选择模型后立即显示该模型的特点
- 分析结果会显示使用的模型名称
- 历史记录中记录每次使用的模型

## 🔧 技术实现

### 前端
- 新增 `selectedModel` 状态管理
- 默认值：`gemini-2.5-flash`
- 通过 API 请求发送模型参数

### 后端
- API 接口 `/api/ai/analyze` 接受可选的 `model` 参数
- `AnalysisEngine` 支持动态创建对应模型的服务实例
- 分析结果保存时记录实际使用的模型

### 数据库
- `AIAnalysis` 表的 `modelUsed` 字段记录每次分析使用的模型
- 可追溯历史分析使用的模型版本

## 📊 模型对比

| 特性 | Flash | Pro | Lite |
|-----|-------|-----|------|
| 速度 | ⚡⚡⚡ 快 | ⚡⚡ 中等 | ⚡⚡⚡⚡ 极快 |
| 质量 | ⭐⭐⭐⭐ 优秀 | ⭐⭐⭐⭐⭐ 卓越 | ⭐⭐⭐ 良好 |
| 成本 | $ 经济 | $$$ 较高 | $ 最低 |
| 推荐度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |

## 💡 使用建议

### 日常工作流
```
需求分析 → Flash（快速迭代）
风险评估 → Flash（足够深度）
技术可行性（简单）→ Flash
技术可行性（复杂）→ Pro（深度分析）
```

### 预算考虑
- **充足预算**：日常 Flash，关键决策 Pro
- **有限预算**：全部使用 Flash
- **极限节省**：简单用 Lite，复杂用 Flash

### 场景推荐

**使用 Flash 的场景**（推荐 90% 场景）：
- ✅ 常规需求分析
- ✅ 风险识别评估
- ✅ 技术可行性初步判断
- ✅ 快速原型评审

**使用 Pro 的场景**（10% 高价值场景）：
- ✅ 关键技术选型决策
- ✅ 复杂系统架构设计
- ✅ 多学科交叉问题分析
- ✅ 高风险项目评估

**使用 Lite 的场景**（轻量级任务）：
- ✅ 简单需求分类
- ✅ 快速总结提取
- ✅ 基础信息核查
- ✅ 高频简单查询

## 🎯 实际案例

### 案例 1：伺服电机控制器需求分析
**选择**：Flash
**理由**：涉及电子、嵌入式、控制算法，Flash 足以提供专业分析
**结果**：2.3秒，质量优秀 ⭐⭐⭐⭐

### 案例 2：多轴联动系统架构设计
**选择**：Pro
**理由**：高度复杂，需要深度推理和架构建议
**结果**：5.8秒，质量卓越，方案详尽 ⭐⭐⭐⭐⭐

### 案例 3：快速风险筛查（20个需求）
**选择**：Lite
**理由**：批量简单筛查，速度优先
**结果**：平均 0.8秒/条，质量满足需求 ⭐⭐⭐

## 🔄 与环境变量配置的关系

现在系统支持**两种配置方式**：

### 方式 1：前端实时选择（优先级更高）
- 用户在界面上选择模型
- 每次分析可以使用不同模型
- 灵活性最高

### 方式 2：环境变量默认值
```env
GEMINI_MODEL="gemini-2.5-flash"
```
- 仅在用户未选择模型时使用
- 作为全局默认配置
- 适合团队统一设置

### 优先级
```
用户界面选择 > 环境变量配置 > 代码默认值
```

## ✨ 未来扩展

可以进一步添加：
- 模型性能实时监控
- 成本统计和预算管理
- 智能模型推荐（根据任务自动选择）
- A/B 测试不同模型效果
- 批量分析任务的模型组合策略

## 🎉 总结

现在您拥有了**完全的灵活性**：
- ✅ 界面实时选择模型
- ✅ 每次分析可用不同模型
- ✅ 清晰的模型说明和推荐
- ✅ 历史记录追溯
- ✅ 无需重启服务器

享受更强大的 AI 分析体验！🚀
