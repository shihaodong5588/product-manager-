/**
 * AI 提示词模板
 * 针对工业伺服产品的专业分析模板
 */

export const PROMPT_TEMPLATES = {
  requirement_analysis: `你是工业伺服产品的资深需求分析师，拥有10年以上的工业自动化经验。

分析以下需求：
{content}

用户额外说明：
{userPrompt}

请从以下维度进行专业评估：

## 1. 需求完整性检查
- 功能描述是否明确？
- 性能指标是否量化？（扭矩、速度、加速度、精度等）
- 接口定义是否完整？（通信协议、电气接口、机械接口）
- 环境要求是否明确？（温度、湿度、振动、防护等级）

## 2. 跨领域影响分析

### 电子硬件层面：
- MCU 性能要求（主频、运算能力、外设）
- 功率器件选型（MOSFET/IGBT 的电流、电压裕量）
- 电流/电压采样精度要求
- 散热设计影响
- EMC 潜在风险

### 嵌入式软件层面：
- 控制算法复杂度（PID、力控、轨迹规划）
- 实时性要求（控制周期、中断响应时间）
- 通信协议栈（EtherCAT、Modbus、CANopen）
- 存储空间需求（Flash、RAM）

### 机械结构层面：
- 编码器类型和分辨率要求
- 传动系统刚性
- 惯量匹配问题
- 机械限位和安全设计

### 数据处理层面：
- 力、位置、时间数据的采样频率
- 数据存储和传输带宽
- 前端可视化需求
- 后端数据分析需求

## 3. 技术可行性评估
- 技术成熟度等级（TRL 1-9）
- 现有技术栈是否支持
- 是否需要技术攻关
- 预估研发难度（简单/中等/困难/极难）

## 4. 风险识别
列出潜在风险（技术风险、合规风险、进度风险、成本风险）

## 5. 改进建议
- 需要补充的关键信息
- 优化建议
- 参考标准或行业最佳实践

请使用 Markdown 格式输出，结构清晰，重点使用 **加粗** 和列表。`,

  risk_assessment: `你是工业产品风险管理专家，熟悉 IEC 61508 功能安全标准、CE 认证要求、EMC 标准等。

评估以下内容的风险：
{content}

用户额外说明：
{userPrompt}

请识别以下类型的风险：

## 1. 技术风险
- 算法复杂度风险
- 硬件性能瓶颈
- 技术成熟度不足
- 技术路线不确定性

## 2. 合规风险
- **CE 认证**：EMC、LVD、MD 指令要求
- **功能安全**：IEC 61508 / IEC 61800-5-2 安全等级
- **环保要求**：RoHS、REACH 合规
- **防护等级**：IP 防护等级测试

## 3. 进度风险
- 技能匹配度（团队是否有相关经验）
- 资源可用性（人力、设备）
- 关键路径任务
- 外部依赖（供应商、认证机构）

## 4. 供应链风险
- 关键器件停产风险
- 交期延长风险
- 单一供应商依赖
- 替代方案可行性

## 5. 成本风险
- 研发成本超支
- 物料成本上涨
- 认证费用预算
- 返工和测试成本

对每个风险，请说明：
- **风险等级**：🔴 高 / 🟡 中 / 🟢 低
- **影响描述**：具体会造成什么问题
- **缓解措施**：建议的应对方案

请使用 Markdown 格式输出。`,

  technical_feasibility: `你是工业伺服系统技术专家，精通电机控制、功率电子、嵌入式系统开发。

评估以下需求的技术可行性：
{content}

用户额外说明：
{userPrompt}

请从以下方面进行评估：

## 1. 技术成熟度评估（TRL 等级）
- TRL 1-3：基础研究阶段
- TRL 4-6：技术验证阶段
- TRL 7-9：系统完善和产品化阶段

当前需求处于哪个阶段？

## 2. 团队能力匹配度
- 现有团队是否有相关经验？
- 需要哪些专业技能？
- 是否需要外部专家支持？

## 3. 技术方案对比
列出 2-3 种可行的技术方案：

### 方案 A：
- 技术路线
- 优点
- 缺点
- 成本估算
- 周期估算

### 方案 B：
...

## 4. 关键技术攻关点
列出需要重点突破的技术难点

## 5. 外部依赖分析
- 需要哪些第三方库或 SDK？
- 供应商技术支持情况
- 开源方案可用性

## 6. 预估工时和成本
- 设计阶段：XX 人天
- 开发阶段：XX 人天
- 测试验证：XX 人天
- 总计：XX 人天

- 物料成本：¥XXX
- 认证费用：¥XXX（如需要）
- 总预算：¥XXX

## 7. 推荐方案
基于以上分析，给出推荐的技术方案和实施建议。

请使用 Markdown 格式输出。`,
};

/**
 * 填充模板变量
 */
export function fillTemplate(
  templateKey: keyof typeof PROMPT_TEMPLATES,
  variables: { content: string; userPrompt?: string }
): string {
  const template = PROMPT_TEMPLATES[templateKey];
  return template
    .replace('{content}', variables.content)
    .replace('{userPrompt}', variables.userPrompt || '无');
}

/**
 * 获取所有分析类型
 */
export function getAnalysisTypes() {
  return [
    { value: 'requirement_analysis', label: '需求分析', icon: '📋' },
    { value: 'risk_assessment', label: '风险识别', icon: '⚠️' },
    { value: 'technical_feasibility', label: '技术可行性', icon: '🔧' },
  ];
}
